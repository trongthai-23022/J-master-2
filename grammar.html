<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JLPT N3 - Lá»™ trÃ¬nh Chinh phá»¥c Ngá»¯ phÃ¡p</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; scroll-behavior: smooth; }
        @keyframes fall { 0% { transform: translateY(-10px); opacity: 1; } 100% { transform: translateY(100vh); opacity: 0; } }
        .confetti-bit { position: absolute; top: 0; animation: fall 1.2s ease-in-out forwards; }
        .gemini-response { animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .loader { width: 20px; height: 20px; border: 3px solid #3b82f6; border-bottom-color: transparent; border-radius: 50%; display: inline-block; box-sizing: border-box; animation: rotation 1s linear infinite; }
        @keyframes rotation { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .tab-active { background-color: #3b82f6; color: white; }
    </style>
</head>
<body class="bg-gradient-to-b from-[#0b1020] to-[#111a2a] text-slate-100">
    <div id="progress-bar" class="fixed top-0 left-0 h-1 bg-gradient-to-r from-indigo-400 via-sky-400 to-emerald-400 transition-all duration-300" style="width: 0%"></div>

    <header class="sticky top-0 z-30 backdrop-blur bg-[#0d142c]/80 border-b border-white/10">
        <div class="max-w-6xl mx-auto px-4 py-3 flex items-center gap-3">
            <div class="w-9 h-9 rounded-xl bg-gradient-to-br from-sky-400 to-blue-500 grid place-items-center font-extrabold text-[#0a1230]">N3</div>
            <div id="header-title" class="font-bold leading-tight">Flow há»c liÃªn tá»¥c (JLPT N3)</div>
            <div id="stats" class="ml-auto flex items-center gap-2 text-sm"></div>
        </div>
    </header>

    <main class="max-w-6xl mx-auto px-4 py-6">
        <div id="group-tabs" class="mb-4 flex flex-wrap gap-2 p-2 rounded-xl bg-black/20"></div>
        <div class="grid md:grid-cols-3 gap-4">
            <aside id="sidebar" class="md:col-span-1 space-y-3"></aside>
            <section id="main-panel" class="md:col-span-2 space-y-4"></section>
        </div>
    </main>
    
    <div id="surprise-toast" class="fixed bottom-4 left-1/2 -translate-x-1/2 z-40 transition-all opacity-0 pointer-events-none"></div>
    <div id="confetti-container" class="pointer-events-none fixed inset-0 overflow-hidden z-50"></div>

    <footer class="max-w-6xl mx-auto px-4 py-10 text-center text-slate-400 text-sm">
        <div>Â© JLPT N3 Flow â€¢ Há»c nhanh â€“ Ã¡p dá»¥ng ngay â€“ tÄƒng tá»‘c Ä‘á»™ lÃ m bÃ i.</div>
    </footer>

<script>
    // --- DATABASE ---
    const grammarGroups = {
        group1: {
            name: 'NhÃ³m 1 â€“ Ná»n táº£ng',
            items: [
                { id: 'uchi-ni', title: 'ï½ã†ã¡ã«', marker: 'Vã‚‹/Vã¦ã„ã‚‹/Aã„/Aãª/Nã® + ã†ã¡ã«', meaning: 'Trong lÃºc cÃ²n...', cues: ['Tranh thá»§', 'Khi tráº¡ng thÃ¡i chÆ°a Ä‘á»•i'], tip: 'ğŸ’¡ Máº¹o: Nháº¥n máº¡nh "tranh thá»§ LÃ€M" trÆ°á»›c khi tráº¡ng thÃ¡i thay Ä‘á»•i. KhÃ¡c vá»›i ã‚ã„ã ã« (chá»‰ má»™t hÃ nh Ä‘á»™ng xáº£y ra song song).', examples: [{jp:'å¿˜ã‚Œãªã„ã†ã¡ã«ã€ãƒ¡ãƒ¢ã—ã¦ãŠã“ã†ã€‚', vn:'Tranh thá»§ lÃºc chÆ°a quÃªn, hÃ£y ghi chÃº láº¡i.'}, {jp:'ãƒ†ãƒ¬ãƒ“ã‚’è¦‹ã¦ã„ã‚‹ã†ã¡ã«ã€å¯ã¦ã—ã¾ã£ãŸã€‚', vn:'Trong lÃºc Ä‘ang xem TV thÃ¬ tÃ´i ngá»§ quÃªn máº¥t.'}], quiz: {q:'ç©ºæ¬„ã«æœ€ã‚‚è‰¯ã„ã‚‚ã®ã‚’ä¸€ã¤é¸ã³ãªã•ã„ã€‚ã€Œæ˜ã‚‹ã„ï¼¿ï¼¿ã€åº­ã®æƒé™¤ã‚’ã—ã¦ã—ã¾ãŠã†ã€‚ã€', options:['ã†ã¡ã«','ã‚ã„ã ã«','ã¨ãã«','ã°ã‹ã‚Šã«'], correct:0, explain:'ã€Œã†ã¡ã«ã€dÃ¹ng khi muá»‘n tranh thá»§ lÃ m gÃ¬ Ä‘Ã³ trÆ°á»›c khi tráº¡ng thÃ¡i thay Ä‘á»•i (trá»i tá»‘i).'} },
                { id: 'ippou-da', title: 'ï½ä¸€æ–¹ã ', marker: 'Vã‚‹ + ä¸€æ–¹ã ', meaning: 'NgÃ y cÃ ng...', cues: ['Xu hÆ°á»›ng', 'Má»™t chiá»u', 'Thay Ä‘á»•i'], tip: 'ğŸ’¡ Máº¹o: TÃ¬m cÃ¡c Ä‘á»™ng tá»« chá»‰ sá»± thay Ä‘á»•i (tÄƒng, giáº£m, xáº¥u Ä‘i...). Chá»‰ Ä‘i vá»›i Vã‚‹.', examples: [{jp:'æœ€è¿‘ã€ç¥–æ¯ã®ç—…æ°—ã¯æ‚ªããªã‚‹ä¸€æ–¹ã ã€‚', vn:'Gáº§n Ä‘Ã¢y, bá»‡nh cá»§a bÃ  tÃ´i ngÃ y cÃ ng trá»Ÿ nÃªn tá»“i tá»‡.'}, {jp:'å††å®‰ãŒé€²ã¿ã€è¼¸å…¥å“ã®å€¤æ®µã¯ä¸ŠãŒã‚‹ä¸€æ–¹ã ã€‚', vn:'Äá»“ng YÃªn máº¥t giÃ¡, giÃ¡ hÃ ng nháº­p kháº©u ngÃ y cÃ ng tÄƒng.'}], quiz: {q:'æœ€è¿‘ã€ã“ã®ç”ºã®äººå£ã¯ï¼¿ï¼¿ï¼¿ï¼¿ä¸€æ–¹ã ã€‚', options:['æ¸›ã£ãŸ','æ¸›ã‚‹','æ¸›ã‚Š','æ¸›ã£ã¦'], correct:1, explain:'Cáº¥u trÃºc ï½ä¸€æ–¹ã  Ä‘i vá»›i Ä‘á»™ng tá»« thá»ƒ tá»« Ä‘iá»ƒn (Vã‚‹).'} },
                { id: 'okage-sei', title: 'ï½ãŠã‹ã’ã§ï¼ï½ã›ã„ã§', marker: 'Thá»ƒ TT + ãŠã‹ã’ã§ï¼ã›ã„ã§', meaning: 'Nhá» cÃ³ / Táº¡i vÃ¬', cues: ['Káº¿t quáº£ Tá»T', 'Káº¿t quáº£ Xáº¤U'], tip: 'ğŸ’¡ Máº¹o: NhÃ¬n váº¿ Káº¾T QUáº¢. Tá»‘t (+) chá»n ãŠã‹ã’ã§, Xáº¥u (-) chá»n ã›ã„ã§.', examples: [{jp:'å‹é”ãŒæ‰‹ä¼ã£ã¦ãã‚ŒãŸãŠã‹ã’ã§ã€ä»•äº‹ãŒæ—©ãçµ‚ã‚ã£ãŸã€‚', vn:'Nhá» báº¡n bÃ¨ giÃºp Ä‘á»¡ mÃ  cÃ´ng viá»‡c Ä‘Ã£ xong sá»›m.'}, {jp:'äº‹æ•…ã®ã›ã„ã§ã€é›»è»ŠãŒé…ã‚Œã¦ã—ã¾ã£ãŸã€‚', vn:'Táº¡i tai náº¡n mÃ  tÃ u Ä‘iá»‡n Ä‘Ã£ bá»‹ muá»™n.'}], quiz: {q:'ãƒã‚¹ãŒé…ã‚ŒãŸï¼¿ï¼¿ï¼¿ï¼¿ã€ä¼šè­°ã«é–“ã«åˆã‚ãªã‹ã£ãŸã€‚', options:['ãŠã‹ã’ã§','ã›ã„ã§','ãŸã‚ã«','ã‹ã‚‰ã“ã'], correct:1, explain:'Káº¿t quáº£ xáº¥u (khÃ´ng ká»‹p há»p) nÃªn dÃ¹ng ã€Œã›ã„ã§ã€.'} },
                { id: 'koto-ni-shiteiru', title: 'ï½ã“ã¨ã«ã—ã¦ã„ã‚‹ï¼ã“ã¨ã«ãªã£ã¦ã„ã‚‹', marker: 'Vã‚‹/Vãªã„ + ã“ã¨ã«...', meaning: 'Tá»± quyáº¿t Ä‘á»‹nh / ÄÃ£ cÃ³ quy Ä‘á»‹nh', cues: ['ThÃ³i quen cÃ¡ nhÃ¢n', 'Quy táº¯c táº­p thá»ƒ'], tip: 'ğŸ’¡ Máº¹o: Chá»§ ngá»¯ lÃ  "tÃ´i" (my rule) â†’ ã“ã¨ã«ã—ã¦ã„ã‚‹. Chá»§ ngá»¯ lÃ  tá»• chá»©c, xÃ£ há»™i (public rule) â†’ ã“ã¨ã«ãªã£ã¦ã„ã‚‹.', examples: [{jp:'å¥åº·ã®ãŸã‚ã€æ¯æœã‚¸ãƒ§ã‚®ãƒ³ã‚°ã™ã‚‹ã“ã¨ã«ã—ã¦ã„ã‚‹ã€‚', vn:'VÃ¬ sá»©c khá»e, tÃ´i quyáº¿t Ä‘á»‹nh cháº¡y bá»™ má»—i sÃ¡ng.'}, {jp:'ç§ã®ä¼šç¤¾ã§ã¯ã€åˆ¶æœã‚’ç€ã‚‹ã“ã¨ã«ãªã£ã¦ã„ã‚‹ã€‚', vn:'á» cÃ´ng ty tÃ´i cÃ³ quy Ä‘á»‹nh lÃ  pháº£i máº·c Ä‘á»“ng phá»¥c.'}], quiz: {q:'ã€Œã“ã®å­¦æ ¡ã§ã¯ã€æ•™å®¤ã§æºå¸¯é›»è©±ã‚’ä½¿ã£ã¦ã¯ã„ã‘ãªã„ï¼¿ï¼¿ï¼¿ï¼¿ã€‚ã€', options:['ã“ã¨ã«ã—ã¦ã„ã‚‹','ã“ã¨ã«ãªã£ã¦ã„ã‚‹','ã‚ˆã†ã«ãªã£ã¦ã„ã‚‹','ã¤ã‚‚ã‚Šã '], correct:1, explain:'ÄÃ¢y lÃ  quy Ä‘á»‹nh cá»§a trÆ°á»ng há»c, khÃ´ng pháº£i quyáº¿t Ä‘á»‹nh cÃ¡ nhÃ¢n.'} },
                { id: 'you-ni-natteiru', title: 'ï½ã‚ˆã†ã«ãªã£ã¦ã„ã‚‹', marker: 'Vã‚‹/Vãªã„ + ã‚ˆã†ã«ãªã£ã¦ã„ã‚‹', meaning: 'CÃ³ cÆ¡ cháº¿/chá»©c nÄƒng tá»± Ä‘á»™ng', cues: ['MÃ¡y mÃ³c', 'Há»‡ thá»‘ng'], tip: 'ğŸ’¡ Máº¹o: Gáº¯n liá»n vá»›i mÃ¡y mÃ³c, thiáº¿t bá»‹, há»‡ thá»‘ng tá»± Ä‘á»™ng. Tháº¥y robot, cá»­a tá»± Ä‘á»™ng, Ä‘iá»u hÃ²a... â†’ nghÄ© ngay Ä‘áº¿n ã‚ˆã†ã«ã—ã¦ã„ã‚‹.', examples: [{jp:'ã“ã®ãƒ‰ã‚¢ã¯ã€äººãŒè¿‘ã¥ãã¨è‡ªå‹•ã§é–‹ãã‚ˆã†ã«ãªã£ã¦ã„ã‚‹ã€‚', vn:'CÃ¡nh cá»­a nÃ y cÃ³ chá»©c nÄƒng tá»± Ä‘á»™ng má»Ÿ khi cÃ³ ngÆ°á»i Ä‘áº¿n gáº§n.'}], quiz: {q:'ã“ã®ã‚¨ã‚¢ã‚³ãƒ³ã¯ã€è¨­å®šæ¸©åº¦ã«ãªã‚‹ã¨é‹è»¢ãŒæ­¢ã¾ã‚‹ï¼¿ï¼¿ï¼¿ï¼¿ã€‚', options:['ã“ã¨ã«ã—ãŸ','ã“ã¨ã«ãªã£ãŸ','ã‚ˆã†ã«ãªã£ã¦ã„ã‚‹','ã¯ãšã '], correct:2, explain:'ÄÃ¢y lÃ  chá»©c nÄƒng tá»± Ä‘á»™ng cá»§a mÃ¡y Ä‘iá»u hÃ²a.'} },
                { id: 'tsumori-da', title: 'ï½ã¤ã‚‚ã‚Šã ', marker: 'Vã‚‹/Vãªã„ + ã¤ã‚‚ã‚Šã ', meaning: 'Dá»± Ä‘á»‹nh, cÃ³ Ã½ Ä‘á»‹nh', cues: ['Káº¿ hoáº¡ch', 'Ã chÃ­'], tip: 'ğŸ’¡ Máº¹o: Diá»…n táº£ Ã½ Ä‘á»‹nh cháº¯c cháº¯n cá»§a ngÆ°á»i nÃ³i táº¡i thá»i Ä‘iá»ƒm nÃ³i. PhÃ¢n biá»‡t vá»›i äºˆå®š (chá»‰ lÃ  lá»‹ch trÃ¬nh).', examples: [{jp:'å¤§å­¦ã‚’å’æ¥­ã—ãŸã‚‰ã€å›½ã¸å¸°ã‚‹ã¤ã‚‚ã‚Šã ã€‚', vn:'Sau khi tá»‘t nghiá»‡p Ä‘áº¡i há»c, tÃ´i dá»± Ä‘á»‹nh sáº½ vá» nÆ°á»›c.'}, {jp:'ã‚‚ã†ã‚¿ãƒã‚³ã¯å¸ã‚ãªã„ã¤ã‚‚ã‚Šã ã€‚', vn:'TÃ´i Ä‘á»‹nh sáº½ khÃ´ng hÃºt thuá»‘c lÃ¡ ná»¯a.'}], quiz: {q:'æ¥å¹´ã€æ—¥æœ¬ã¸ç•™å­¦ã™ã‚‹ï¼¿ï¼¿ï¼¿ï¼¿ã€‚', options:['ã¯ãšã ','ã‚ã‘ã ','ã¤ã‚‚ã‚Šã ','ã“ã¨ã '], correct:2, explain:'Thá»ƒ hiá»‡n dá»± Ä‘á»‹nh, káº¿ hoáº¡ch trong tÆ°Æ¡ng lai.'} },
                { id: 'te-hoshii', title: 'ï½ã¦ã»ã—ã„ï¼ã¦ã‚‚ã‚‰ã„ãŸã„', marker: 'Vã¦/Vãªã„ã§ + ã»ã—ã„', meaning: 'Muá»‘n ai Ä‘Ã³ lÃ m/khÃ´ng lÃ m gÃ¬', cues: ['YÃªu cáº§u', 'Nguyá»‡n vá»ng'], tip: 'ğŸ’¡ Máº¹o: Chá»§ thá»ƒ muá»‘n lÃ  "tÃ´i", nhÆ°ng hÃ nh Ä‘á»™ng lÃ  cá»§a "ngÆ°á»i khÃ¡c".', examples: [{jp:'ã“ã®æ›¸é¡ã€æ˜æ—¥ã¾ã§ã«ã‚³ãƒ”ãƒ¼ã—ã¦ã»ã—ã„ã‚“ã§ã™ãŒã€‚', vn:'TÃ´i muá»‘n báº¡n photo tÃ i liá»‡u nÃ y trÆ°á»›c ngÃ y mai.'}, {jp:'éƒ¨å±‹ã®ä¸­ã§ã¯ã‚¿ãƒã‚³ã‚’å¸ã‚ãªã„ã§ã»ã—ã„ã€‚', vn:'TÃ´i muá»‘n báº¡n khÃ´ng hÃºt thuá»‘c trong phÃ²ng.'}], quiz: {q:'çˆ¶ã«ã€ã„ã¤ã¾ã§ã‚‚å…ƒæ°—ã§ï¼¿ï¼¿ï¼¿ï¼¿ã€‚', options:['ã„ã¦ã»ã—ã„','ã„ãŸã„ã ','ã‚ã‚‹ã¹ãã ','ã„ã•ã›ã‚‹'], correct:0, explain:'Thá»ƒ hiá»‡n nguyá»‡n vá»ng muá»‘n ngÆ°á»i khÃ¡c (bá»‘) lÃ m gÃ¬ Ä‘Ã³ (sá»‘ng khá»e).'} },
                { id: 'bakari-denaku', title: 'ï½ã°ã‹ã‚Šã§ãªã', marker: 'Thá»ƒ TT + ã°ã‹ã‚Šã§ãªãã€ï½ã‚‚', meaning: 'KhÃ´ng chá»‰ A mÃ  cÃ²n B', cues: ['ThÃªm vÃ o', 'KhÃ´ng chá»‰...'], tip: 'ğŸ’¡ Máº¹o: Máº«u cÃ¢u trang trá»ng hÆ¡n ã ã‘ã§ãªã. Váº¿ sau thÆ°á»ng cÃ³ ã‚‚.', examples: [{jp:'å½¼å¥³ã¯è‹±èªã°ã‹ã‚Šã§ãªãã€æ—¥æœ¬èªã‚‚è©±ã›ã‚‹ã€‚', vn:'CÃ´ áº¥y khÃ´ng chá»‰ nÃ³i Ä‘Æ°á»£c tiáº¿ng Anh mÃ  cÃ²n cáº£ tiáº¿ng Nháº­t.'}], quiz: {q:'ã“ã®ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ã¯ã€å‘³ãŒè‰¯ã„ï¼¿ï¼¿ï¼¿ï¼¿å€¤æ®µã‚‚å®‰ã„ã€‚', options:['ã ã‘ã§ãªã','ã°ã‹ã‚Šã«','ã ã‘ã‚ã£ã¦','ã ã‘ã®'], correct:0, explain:'Ná»‘i hai Ä‘áº·c Ä‘iá»ƒm tá»‘t (vá»‹ ngon, giÃ¡ ráº»).'} },
                { id: 'tekara-denaito', title: 'ï½ã¦ã‹ã‚‰ã§ãªã„ã¨â€¦ãªã„', marker: 'Vã¦ + ã‹ã‚‰ã§ãªã„ã¨', meaning: 'Náº¿u chÆ°a lÃ m A thÃ¬ khÃ´ng thá»ƒ B', cues: ['Äiá»u kiá»‡n tiÃªn quyáº¿t'], tip: 'ğŸ’¡ Máº¹o: Váº¿ sau luÃ´n lÃ  phá»§ Ä‘á»‹nh (ï½ãªã„, ã§ããªã„, ç„¡ç†ã ...).', examples: [{jp:'å®¶æ—ã¨ç›¸è«‡ã—ã¦ã‹ã‚‰ã§ãªã„ã¨ã€è¿”äº‹ã¯ã§ãã¾ã›ã‚“ã€‚', vn:'Náº¿u chÆ°a tháº£o luáº­n vá»›i gia Ä‘Ã¬nh thÃ¬ tÃ´i khÃ´ng thá»ƒ tráº£ lá»i Ä‘Æ°á»£c.'}], quiz: {q:'ãŠé‡‘ã‚’æ‰•ã£ã¦ï¼¿ï¼¿ï¼¿ï¼¿ã€å•†å“ã‚’å—ã‘å–ã‚‹ã“ã¨ã¯ã§ããªã„ã€‚', options:['ã‹ã‚‰ã§ãªãã¦','ã‹ã‚‰ã§ãªã„ã¨','ã‹ã‚‰ã§ã¯','ã‹ã‚‰ã¯'], correct:1, explain:'Cáº¥u trÃºc cá»‘ Ä‘á»‹nh, diá»…n táº£ Ä‘iá»u kiá»‡n cáº§n pháº£i lÃ m trÆ°á»›c.'} },
                { id: 'you-ni', title: 'ï½ã‚ˆã†ã«', marker: 'Vã‚‹/Vãªã„ + ã‚ˆã†ã«', meaning: 'Äá»ƒ... (má»¥c Ä‘Ã­ch)', cues: ['Má»¥c tiÃªu tráº¡ng thÃ¡i', 'VÃ´ Ã½ chÃ­'], tip: 'ğŸ’¡ Máº¹o: DÃ¹ng cho má»¥c Ä‘Ã­ch khÃ´ng thá»ƒ kiá»ƒm soÃ¡t báº±ng Ã½ chÃ­ (vd: èã“ãˆã‚‹, è¦‹ãˆã‚‹, ã‚ã‹ã‚‹). KhÃ¡c vá»›i ãŸã‚ã« (dÃ¹ng cho hÃ nh Ä‘á»™ng cÃ³ Ã½ chÃ­).', examples: [{jp:'æ—¥æœ¬èªãŒè©±ã›ã‚‹ã‚ˆã†ã«ã€æ¯æ—¥å‹‰å¼·ã—ã¦ã„ã¾ã™ã€‚', vn:'Äá»ƒ cÃ³ thá»ƒ nÃ³i Ä‘Æ°á»£c tiáº¿ng Nháº­t, tÃ´i há»c má»—i ngÃ y.'}, {jp:'å¿˜ã‚Œãªã„ã‚ˆã†ã«ã€ãƒ¡ãƒ¢ã—ã¦ãã ã•ã„ã€‚', vn:'HÃ£y ghi chÃº láº¡i Ä‘á»ƒ khÃ´ng quÃªn.'}], quiz: {q:'é¢¨é‚ªã‚’ï¼¿ï¼¿ï¼¿ï¼¿ã‚ˆã†ã«ã€æ°—ã‚’ã¤ã‘ã¦ãã ã•ã„ã€‚', options:['ã²ã‹ãªã„','ã²ã‹ãšã«','ã²ããŸããªã„','ã²ã‹ã›ãªã„'], correct:0, explain:'Diá»…n táº£ má»¥c Ä‘Ã­ch Ä‘á»ƒ má»™t tráº¡ng thÃ¡i khÃ´ng xáº£y ra (khÃ´ng bá»‹ cáº£m).'} },
                { id: 'hazu-wake', title: 'ã¯ãšã ï¼ã‚ã‘ã ', marker: 'Thá»ƒ TT + ã¯ãšã ï¼ã‚ã‘ã ', meaning: 'Cháº¯c cháº¯n lÃ  / Tháº£o nÃ o mÃ ', cues: ['Suy luáº­n cÃ³ cÄƒn cá»©', 'Hiá»ƒu ra lÃ½ do'], tip: 'ğŸ’¡ Máº¹o: ã¯ãšã  lÃ  suy luáº­n logic (Aâ†’B). ã‚ã‘ã  lÃ  sá»± giÃ¡c ngá»™, hiá»ƒu ra ("Ã , ra lÃ  tháº¿!").', examples: [{jp:'å½¼ã¯æ˜¨æ—¥æ—¥æœ¬ã«æ¥ãŸã°ã‹ã‚Šã ã‹ã‚‰ã€æ—¥æœ¬èªãŒä¸Šæ‰‹ãªã¯ãšãŒãªã„ã€‚', vn:'Anh áº¥y má»›i Ä‘áº¿n Nháº­t hÃ´m qua nÃªn cháº¯c cháº¯n khÃ´ng thá»ƒ giá»i tiáº¿ng Nháº­t Ä‘Æ°á»£c.'}, {jp:'å¤œãªã®ã«é›»æ°—ãŒã¤ã„ã¦ã„ã‚‹ã€‚éƒ¨å±‹ã«èª°ã‹ã„ã‚‹ã‚ã‘ã ã€‚', vn:'DÃ¹ lÃ  ban Ä‘Ãªm mÃ  Ä‘Ã¨n váº«n sÃ¡ng. Tháº£o nÃ o trong phÃ²ng cÃ³ ngÆ°á»i.'}], quiz: {q:'ã€Œæš‘ã„ï¼¿ï¼¿ï¼¿ï¼¿ã€‚ã‚¯ãƒ¼ãƒ©ãƒ¼ãŒã¤ã„ã¦ã„ãªã„ã‚“ã ã€‚ã€', options:['ã¯ãšã ','ã‚ã‘ã ','ã¤ã‚‚ã‚Šã ','ã‚ˆã†ã '], correct:1, explain:'Diá»…n táº£ sá»± tháº¥u hiá»ƒu, nháº­n ra lÃ½ do ("Tháº£o nÃ o nÃ³ng tháº¿").'} },
                { id: 'wake-series', title: 'ã‚ã‘ãŒãªã„ï¼ã§ã¯ãªã„ï¼ã«ã¯ã„ã‹ãªã„', marker: 'Vã‚‹ + ã‚ã‘...', meaning: 'KhÃ´ng thá»ƒ nÃ o / KhÃ´ng háº³n / KhÃ´ng thá»ƒ (vÃ¬ lÃ½ do khÃ¡c)', cues: ['Phá»§ Ä‘á»‹nh máº¡nh', 'Phá»§ Ä‘á»‹nh má»™t pháº§n', 'RÃ ng buá»™c'], tip: 'ğŸ’¡ Máº¹o: ãªã„ = 100% khÃ´ng. ã§ã¯ãªã„ = khÃ´ng pháº£i 100%. ã«ã¯ã„ã‹ãªã„ = muá»‘n lÃ m nhÆ°ng khÃ´ng Ä‘Æ°á»£c (do Ã¡p lá»±c xÃ£ há»™i, Ä‘áº¡o Ä‘á»©c).', examples: [{jp:'ã“ã‚“ãªã«é«˜ã„ã‚‚ã®ã€ç§ã«è²·ãˆã‚‹ã‚ã‘ãŒãªã„ã€‚', vn:'Äá»“ Ä‘áº¯t tháº¿ nÃ y, lÃ m sao tÃ´i mua ná»•i.'}, {jp:'æ–™ç†ãŒã§ããªã„ã‚ã‘ã§ã¯ãªã„ãŒã€å¿™ã—ã„ã‹ã‚‰ã‚ã¾ã‚Šä½œã‚‰ãªã„ã€‚', vn:'KhÃ´ng háº³n lÃ  tÃ´i khÃ´ng biáº¿t náº¥u Äƒn, nhÆ°ng vÃ¬ báº­n nÃªn khÃ´ng hay náº¥u.'}, {jp:'å¤§äº‹ãªä¼šè­°ãŒã‚ã‚‹ã®ã§ã€ä»Šæ—¥ã¯ä¼‘ã‚€ã‚ã‘ã«ã¯ã„ã‹ãªã„ã€‚', vn:'VÃ¬ cÃ³ cuá»™c há»p quan trá»ng nÃªn hÃ´m nay tÃ´i khÃ´ng thá»ƒ nghá»‰ Ä‘Æ°á»£c.'}], quiz: {q:'ç—…æ°—ã®å­ä¾›ã‚’ä¸€äººã§å®¶ã«ç½®ã„ã¦ã€ä»•äº‹ã«è¡Œãï¼¿ï¼¿ï¼¿ï¼¿ã€‚', options:['ã‚ã‘ãŒãªã„','ã‚ã‘ã§ã¯ãªã„','ã‚ã‘ã«ã¯ã„ã‹ãªã„','ã¯ãšãŒãªã„'], correct:2, explain:'KhÃ´ng thá»ƒ Ä‘i lÃ m vÃ¬ rÃ ng buá»™c vá» máº·t tÃ¬nh cáº£m, trÃ¡ch nhiá»‡m.'} },
                { id: 'ni-chigainai', title: 'ï½ã«é•ã„ãªã„', marker: 'Thá»ƒ TT + ã«é•ã„ãªã„', meaning: 'Cháº¯c cháº¯n lÃ , áº¯t háº³n lÃ ', cues: ['Suy Ä‘oÃ¡n cháº¯c cháº¯n'], tip: 'ğŸ’¡ Máº¹o: Má»©c Ä‘á»™ cháº¯c cháº¯n cao hÆ¡n ã¯ãšã , mang tÃ­nh chá»§ quan cá»§a ngÆ°á»i nÃ³i nhiá»u hÆ¡n.', examples: [{jp:'ã‚ã‚“ãªã«ç·´ç¿’ã—ãŸã®ã ã‹ã‚‰ã€å½¼ã¯ãã£ã¨åˆæ ¼ã™ã‚‹ã«é•ã„ãªã„ã€‚', vn:'ÄÃ£ luyá»‡n táº­p nhiá»u nhÆ° váº­y, anh áº¥y cháº¯c cháº¯n sáº½ Ä‘á»—.'}], quiz: {q:'ã‚ã®åº—ã®å‰ã«ã¯ã„ã¤ã‚‚è¡Œåˆ—ãŒã§ãã¦ã„ã‚‹ã€‚ãã£ã¨ï¼¿ï¼¿ï¼¿ï¼¿ã«é•ã„ãªã„ã€‚', options:['ãŠã„ã—ã„','ãŠã„ã—ãã¦','ãŠã„ã—ã„ã§','ãŠã„ã—ã•'], correct:0, explain:'Äi vá»›i thá»ƒ thÃ´ng thÆ°á»ng cá»§a tÃ­nh tá»«.'} },
                { id: 'koto-ni-naru', title: 'ï½ã“ã¨ã«ãªã‚‹', marker: 'Vã‚‹/Vãªã„ + ã“ã¨ã«ãªã‚‹', meaning: 'ÄÆ°á»£c quyáº¿t Ä‘á»‹nh lÃ ...', cues: ['Káº¿t quáº£', 'Quyáº¿t Ä‘á»‹nh khÃ´ng do báº£n thÃ¢n'], tip: 'ğŸ’¡ Máº¹o: PhÃ¢n biá»‡t vá»›i ã“ã¨ã«ã™ã‚‹ (tÃ´i quyáº¿t Ä‘á»‹nh). ã“ã¨ã«ãªã‚‹ lÃ  quyáº¿t Ä‘á»‹nh cá»§a ngÆ°á»i khÃ¡c/tá»• chá»©c Ã¡p lÃªn tÃ´i.', examples: [{jp:'æ¥æœˆã€å¤§é˜ªã¸å‡ºå¼µã™ã‚‹ã“ã¨ã«ãªã‚Šã¾ã—ãŸã€‚', vn:'ÄÃ£ Ä‘Æ°á»£c quyáº¿t Ä‘á»‹nh lÃ  thÃ¡ng sau tÃ´i sáº½ Ä‘i cÃ´ng tÃ¡c á»Ÿ Osaka.'}], quiz: {q:'è©±ã—åˆã„ã®çµæœã€æ¥é€±ã‹ã‚‰æ–°ã—ã„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’å§‹ã‚ã‚‹ï¼¿ï¼¿ï¼¿ï¼¿ã€‚', options:['ã“ã¨ã«ã—ãŸ','ã“ã¨ã«ãªã£ãŸ','ã‚ˆã†ã«ãªã£ãŸ','ã¤ã‚‚ã‚Šã ã£ãŸ'], correct:1, explain:'Diá»…n táº£ má»™t quyáº¿t Ä‘á»‹nh Ä‘Æ°á»£c Ä‘Æ°a ra bá»Ÿi má»™t táº­p thá»ƒ (káº¿t quáº£ cuá»™c há»p).'} }
            ]
        },
        group2: {
            name: 'NhÃ³m 2 â€“ Má»Ÿ rá»™ng',
            items: [
                { id: 'mitai-you-rashii', title: 'ï½ã¿ãŸã„ï¼ã‚ˆã†ã ï¼ã‚‰ã—ã„', marker: 'So sÃ¡nh & Phá»ng Ä‘oÃ¡n', meaning: 'Giá»‘ng nhÆ° / CÃ³ váº» / Nghe nÃ³i, Ä‘áº­m cháº¥t', cues: ['VÄƒn nÃ³i (ã¿ãŸã„)', 'VÄƒn viáº¿t/trung tÃ­nh (ã‚ˆã†ã )', 'Tin Ä‘á»“n/Báº£n cháº¥t (ã‚‰ã—ã„)'], tip: 'ğŸ’¡ Máº¹o: ã‚‰ã—ã„ cÃ³ 2 nghÄ©a: 1. Nghe nÃ³i (tin Ä‘á»“n). 2. Äáº­m cháº¥t (ç”·ã‚‰ã—ã„). ã‚ˆã†ã /ã¿ãŸã„ã  lÃ  phá»ng Ä‘oÃ¡n dá»±a trÃªn nhá»¯ng gÃ¬ tháº¥y/cáº£m nháº­n.', examples: [{jp:'ä»Šæ—¥ã¯æ˜¥ã‚‰ã—ã„æš–ã‹ã„æ—¥ã§ã™ã­ã€‚', vn:'HÃ´m nay lÃ  má»™t ngÃ y áº¥m Ã¡p Ä‘áº­m cháº¥t xuÃ¢n nhá»‰.'}, {jp:'ã‚ã®äººã¯ç”·ã¿ãŸã„ã ã‘ã©ã€å®Ÿã¯å¥³ã®äººã ã€‚', vn:'NgÆ°á»i kia trÃ´ng giá»‘ng con trai nhÆ°ng thá»±c ra lÃ  con gÃ¡i.'}, {jp:'å¤©æ°—äºˆå ±ã«ã‚ˆã‚‹ã¨ã€æ˜æ—¥ã¯é›¨ãŒé™ã‚‹ã‚ˆã†ã§ã™ã€‚', vn:'Theo dá»± bÃ¡o thá»i tiáº¿t, cÃ³ váº» ngÃ y mai trá»i sáº½ mÆ°a.'}], quiz: {q:'å½¼ã¯ã„ã¤ã‚‚å†—è«‡ã°ã‹ã‚Šè¨€ã£ã¦ã„ã‚‹ã€‚æœ¬å½“ã«ï¼¿ï¼¿ï¼¿ï¼¿äººã ã€‚', options:['å­ä¾›ã‚‰ã—ã„','å­ä¾›ã®ã‚ˆã†ãª','å­ä¾›ã¿ãŸã„ãª','å­ä¾›ã£ã½ã„'], correct:3, explain:'ã€Œã€œã£ã½ã„ã€dÃ¹ng Ä‘á»ƒ chá»‰ cáº£m giÃ¡c, áº¥n tÆ°á»£ng bá» ngoÃ i, mang tÃ­nh tiÃªu cá»±c nháº¹.'} },
                { id: 'kurai-hodo', title: 'ï½ãã‚‰ã„ï¼ãã‚‰ã„ï¼ã»ã©', marker: 'Thá»ƒ TT + ãã‚‰ã„/ã»ã©', meaning: 'Äáº¿n má»©c, khoáº£ng', cues: ['So sÃ¡nh má»©c Ä‘á»™', 'Má»©c Ä‘á»™ cao nháº¥t (ã»ã©ï½ãªã„)'], tip: 'ğŸ’¡ Máº¹o: Cáº¥u trÃºc so sÃ¡nh báº­c nháº¥t: ã€ŒN ã»ã© ï½ ã¯ãªã„ã€ (KhÃ´ng cÃ³ gÃ¬ ... báº±ng N).', examples: [{jp:'å–‰ãŒç—›ãã¦ã€å£°ãŒå‡ºãªã„ãã‚‰ã„ã ã€‚', vn:'TÃ´i Ä‘au há»ng Ä‘áº¿n má»©c khÃ´ng nÃ³i ra tiáº¿ng.'}, {jp:'ä»Šå¹´ã»ã©é›ªãŒé™ã£ãŸå¹´ã¯ãªã‹ã£ãŸã€‚', vn:'ChÆ°a cÃ³ nÄƒm nÃ o tuyáº¿t rÆ¡i nhiá»u nhÆ° nÄƒm nay.'}], quiz: {q:'å½¼å¥³ï¼¿ï¼¿ï¼¿è¦ªåˆ‡ãªäººã¯ã„ãªã„ã€‚', options:['ãã‚‰ã„','ã°ã‹ã‚Š','ã»ã©','ã ã‘'], correct:2, explain:'ã€ŒNã»ã©ï½ãªã„ã€lÃ  cáº¥u trÃºc so sÃ¡nh cao nháº¥t, nghÄ©a lÃ  "khÃ´ng ai tá»‘t bá»¥ng báº±ng cÃ´ áº¥y".'} },
                { id: 'sae-ba', title: 'ï½ã•ãˆï½ã°', marker: 'Nã•ãˆ + Vã° / Aã‘ã‚Œã° / Aãªã‚‰ / Nãªã‚‰', meaning: 'Chá»‰ cáº§n... lÃ  Ä‘á»§', cues: ['Äiá»u kiá»‡n tá»‘i thiá»ƒu'], tip: 'ğŸ’¡ Máº¹o: Nháº¥n máº¡nh Ä‘iá»u kiá»‡n Cá»T LÃ•I vÃ  DUY NHáº¤T. Chá»‰ cáº§n cÃ³ nÃ³ lÃ  má»i thá»© OK.', examples: [{jp:'ã‚ãªãŸã•ãˆã„ã‚Œã°ã€ä»–ã«ä½•ã‚‚ã„ã‚‰ãªã„ã€‚', vn:'Chá»‰ cáº§n cÃ³ anh, em khÃ´ng cáº§n gÃ¬ khÃ¡c ná»¯a.'}, {jp:'ä½æ‰€ã•ãˆåˆ†ã‹ã‚Œã°ã€åœ°å›³ã§æ¢ã›ã¾ã™ã€‚', vn:'Chá»‰ cáº§n biáº¿t Ä‘á»‹a chá»‰ lÃ  cÃ³ thá»ƒ tÃ¬m báº±ng báº£n Ä‘á»“.'}], quiz: {q:'ãŠé‡‘ï¼¿ï¼¿ï¼¿ã‚ã‚Œã°ã€ä½•ã§ã‚‚è²·ãˆã‚‹ã®ã«ã€‚', options:['ã•ãˆ','ã ã‘','ã—ã‹','ã“ã'], correct:0, explain:'ã€Œã•ãˆã€nháº¥n máº¡nh Ä‘iá»u kiá»‡n tá»‘i thiá»ƒu vÃ  duy nháº¥t.'} },
                { id: 'shikanai', title: 'ï½ã—ã‹ãªã„', marker: 'Vã‚‹ + ã—ã‹ãªã„', meaning: 'Chá»‰ cÃ²n cÃ¡ch lÃ ...', cues: ['KhÃ´ng cÃ³ lá»±a chá»n khÃ¡c'], tip: 'ğŸ’¡ Máº¹o: Diá»…n táº£ tÃ¬nh tháº¿ báº¯t buá»™c, khÃ´ng cÃ²n lá»±a chá»n nÃ o khÃ¡c tá»‘t hÆ¡n.', examples: [{jp:'ãƒã‚¹ã‚‚é›»è»Šã‚‚æ­¢ã¾ã£ãŸã®ã§ã€æ­©ã„ã¦å¸°ã‚‹ã—ã‹ãªã„ã€‚', vn:'VÃ¬ xe buÃ½t vÃ  tÃ u Ä‘á»u dá»«ng nÃªn chá»‰ cÃ²n cÃ¡ch Ä‘i bá»™ vá» nhÃ .'}], quiz: {q:'èª°ã‚‚æ‰‹ä¼ã£ã¦ãã‚Œãªã„ã‹ã‚‰ã€ä¸€äººã§ï¼¿ï¼¿ï¼¿ï¼¿ã€‚', options:['ã‚„ã‚‹ã¹ãã ','ã‚„ã‚‹ã‚‰ã—ã„','ã‚„ã‚‹ã—ã‹ãªã„','ã‚„ã‚‹ã¾ã„'], correct:2, explain:'Diá»…n táº£ tÃ¬nh huá»‘ng khÃ´ng cÃ²n sá»± lá»±a chá»n nÃ o khÃ¡c.'} },
                { id: 'tabi-ni', title: 'ï½ãŸã³ã«', marker: 'Vã‚‹/Nã® + ãŸã³ã«', meaning: 'Cá»© má»—i láº§n...', cues: ['Láº·p láº¡i'], tip: 'ğŸ’¡ Máº¹o: Cá»© A xáº£y ra thÃ¬ B cÅ©ng xáº£y ra. LuÃ´n luÃ´n lÃ  nhÆ° váº­y.', examples: [{jp:'ã“ã®å†™çœŸã‚’è¦‹ã‚‹ãŸã³ã«ã€æ¥½ã—ã‹ã£ãŸé ƒã‚’æ€ã„å‡ºã™ã€‚', vn:'Cá»© má»—i láº§n xem bá»©c áº£nh nÃ y, tÃ´i láº¡i nhá»› vá» khoáº£ng thá»i gian vui váº».'}], quiz: {q:'å½¼ã¯ä¼šã†ï¼¿ï¼¿ï¼¿ï¼¿ã€åŒã˜è©±ã‚’ã™ã‚‹ã€‚', options:['ã†ã¡ã«','ãŸã³ã«','ã›ã„ã§','ã‚ã„ã ã«'], correct:1, explain:'Diá»…n táº£ má»™t hÃ nh Ä‘á»™ng láº·p Ä‘i láº·p láº¡i má»—i khi cÃ³ má»™t sá»± kiá»‡n khÃ¡c xáº£y ra.'} },
                { id: 'tsui-teshimau', title: 'ï½ã¤ã„ï½ã¦ã—ã¾ã†', marker: 'ã¤ã„ + Vã¦ã—ã¾ã†', meaning: 'Lá»¡ lÃ m gÃ¬ Ä‘Ã³ (vÃ´ thá»©c)', cues: ['KhÃ´ng kiá»ƒm soÃ¡t Ä‘Æ°á»£c'], tip: 'ğŸ’¡ Máº¹o: HÃ nh Ä‘á»™ng bá»™t phÃ¡t, khÃ´ng cÃ³ chá»§ Ã½, thÆ°á»ng lÃ  thÃ³i quen xáº¥u hoáº·c Ä‘iá»u Ä‘Ã¡ng tiáº¿c.', examples: [{jp:'ãƒ€ã‚¤ã‚¨ãƒƒãƒˆä¸­ãªã®ã«ã€ã¤ã„ã‚±ãƒ¼ã‚­ã‚’é£Ÿã¹ã¦ã—ã¾ã£ãŸã€‚', vn:'Äang Äƒn kiÃªng váº­y mÃ  tÃ´i Ä‘Ã£ lá»¡ Äƒn bÃ¡nh máº¥t rá»“i.'}], quiz: {q:'é¢ç™½ãã¦ã€ã¤ã„å¤œé…ãã¾ã§æ¼«ç”»ã‚’ï¼¿ï¼¿ï¼¿ï¼¿ã€‚', options:['èª­ã‚“ã§ã„ã‚‹','èª­ã‚“ã§ã°ã‹ã‚Šã ','èª­ã‚“ã§ã—ã¾ã£ãŸ','èª­ã¾ãªã‘ã‚Œã°ãªã‚‰ãªã„'], correct:2, explain:'ã€Œã¤ã„ï½ã¦ã—ã¾ã†ã€diá»…n táº£ hÃ nh Ä‘á»™ng lá»¡ lÃ m, khÃ´ng cÃ³ chá»§ Ã½.'} },
                { id: 'furi-wo-suru', title: 'ï½ãµã‚Šã‚’ã™ã‚‹', marker: 'Thá»ƒ TT + ãµã‚Šã‚’ã™ã‚‹', meaning: 'Giáº£ vá»...', cues: ['HÃ nh Ä‘á»™ng khÃ´ng tháº­t'], tip: 'ğŸ’¡ Máº¹o: HÃ nh Ä‘á»™ng cÃ³ Ã½ thá»©c, cá»‘ tÃ¬nh tá» ra má»™t tráº¡ng thÃ¡i khÃ´ng cÃ³ tháº­t.', examples: [{jp:'å½¼ã¯èã“ãˆãªã„ãµã‚Šã‚’ã—ã¦ã€è¿”äº‹ã‚’ã—ãªã‹ã£ãŸã€‚', vn:'Anh ta giáº£ vá» khÃ´ng nghe vÃ  Ä‘Ã£ khÃ´ng tráº£ lá»i.'}], quiz: {q:'ç”°ä¸­ã•ã‚“ã¯ã€çŸ¥ã£ã¦ã„ã‚‹ã®ã«ï¼¿ï¼¿ï¼¿ï¼¿ãµã‚Šã‚’ã—ã¦ã„ã‚‹ã€‚', options:['çŸ¥ã‚‰ãªã„','çŸ¥ã‚‰ãªã„ã§','çŸ¥ã‚‰ãªãã¦','çŸ¥ã‚‰ãšã«'], correct:0, explain:'Äi vá»›i thá»ƒ thÃ´ng thÆ°á»ng (Vãªã„) trÆ°á»›c ã€Œãµã‚Šã€.'} },
                { id: 'beki-da', title: 'ï½ã¹ãã ', marker: 'Vã‚‹ + ã¹ãã ', meaning: 'NÃªn lÃ m... (nghÄ©a vá»¥, Ä‘áº¡o Ä‘á»©c)', cues: ['Lá»i khuyÃªn máº¡nh'], tip: 'ğŸ’¡ Máº¹o: Mang tÃ­nh quy chuáº©n xÃ£ há»™i, Ä‘áº¡o Ä‘á»©c. "LÃ m ngÆ°á»i thÃ¬ nÃªn...". Máº¡nh hÆ¡n ï½ã»ã†ãŒã„ã„.', examples: [{jp:'å­¦ç”Ÿã¯ã‚‚ã£ã¨å‹‰å¼·ã™ã‚‹ã¹ãã ã€‚', vn:'Há»c sinh nÃªn há»c nhiá»u hÆ¡n ná»¯a.'}], quiz: {q:'ç´„æŸã¯ï¼¿ï¼¿ï¼¿ï¼¿ã¹ãã ã€‚', options:['å®ˆã‚‹','å®ˆã£ã¦','å®ˆã‚Œã°','å®ˆã‚Š'], correct:0, explain:'Äi vá»›i Ä‘á»™ng tá»« thá»ƒ tá»« Ä‘iá»ƒn, mang Ã½ nghÄ©a nÃªn lÃ m Ä‘iá»u Ä‘Ã³ lÃ  Ä‘Æ°Æ¡ng nhiÃªn.'} },
                { id: 'temo-kamawanai', title: 'ï½ã¦ã‚‚æ§‹ã‚ãªã„', marker: 'Vã¦ã‚‚/Aãã¦ã‚‚/Aãªã§ã‚‚/Nã§ã‚‚ + æ§‹ã‚ãªã„', meaning: '...cÅ©ng khÃ´ng sao, ...cÅ©ng Ä‘Æ°á»£c', cues: ['Cho phÃ©p'], tip: 'ğŸ’¡ Máº¹o: CÃ¡ch nÃ³i cho phÃ©p, lá»‹ch sá»± hÆ¡n ï½ã¦ã‚‚ã„ã„.', examples: [{jp:'ãŠãªã‹ãŒã™ã„ãŸã‚‰ã€å…ˆã«é£Ÿã¹ã¦ã‚‚æ§‹ã„ã¾ã›ã‚“ã‚ˆã€‚', vn:'Náº¿u Ä‘Ã³i bá»¥ng thÃ¬ Äƒn trÆ°á»›c cÅ©ng khÃ´ng sao Ä‘Ã¢u.'}], quiz: {q:'ã“ã®æ›¸é¡ã¯ã€æ˜æ—¥ï¼¿ï¼¿ï¼¿ï¼¿æ§‹ã„ã¾ã›ã‚“ã€‚', options:['å‡ºã—ã¦','å‡ºã—ã¦ã‚‚','å‡ºã™ãªã‚‰','å‡ºã™ã«ã¯'], correct:1, explain:'Diá»…n táº£ sá»± cho phÃ©p, "ná»™p vÃ o ngÃ y mai cÅ©ng Ä‘Æ°á»£c".'} },
                { id: 'ni-yoru', title: 'ï½ã«ã‚ˆã‚‹ï¼ã«ã‚ˆã£ã¦', marker: 'N + ã«ã‚ˆã£ã¦', meaning: 'Do, bá»Ÿi, tÃ¹y vÃ o', cues: ['NguyÃªn nhÃ¢n', 'PhÆ°Æ¡ng tiá»‡n', 'TÃ¹y trÆ°á»ng há»£p'], tip: 'ğŸ’¡ Máº¹o: Ráº¥t Ä‘a nÄƒng! 1. NguyÃªn nhÃ¢n (å°é¢¨ã«ã‚ˆã£ã¦). 2. PhÆ°Æ¡ng tiá»‡n (ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã«ã‚ˆã£ã¦). 3. TÃ¹y thuá»™c vÃ o (äººã«ã‚ˆã£ã¦).', examples: [{jp:'äººã«ã‚ˆã£ã¦è€ƒãˆæ–¹ãŒé•ã†ã€‚', vn:'TÃ¹y má»—i ngÆ°á»i mÃ  cÃ¡ch suy nghÄ© khÃ¡c nhau.'}], quiz: {q:'ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆï¼¿ï¼¿ï¼¿ï¼¿ã€ä¸–ç•Œä¸­ã®æƒ…å ±ã‚’çŸ¥ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚', options:['ã«ã¨ã£ã¦','ã«ã‚ˆã£ã¦','ã«ã¤ã„ã¦','ã«å¯¾ã—ã¦'], correct:1, explain:'Diá»…n táº£ phÆ°Æ¡ng tiá»‡n, cÃ¡ch thá»©c ("báº±ng internet").'} },
                { id: 'ni-series-2', title: 'ã«ã¨ã£ã¦ï¼ã«ã¤ã„ã¦ï¼ã«å¯¾ã—ã¦ï¼ã«åã—ã¦', marker: 'N + ï½', meaning: 'Äá»‘i vá»›i / Vá» / Äá»‘i vá»›i, trÃ¡i vá»›i / TrÃ¡i vá»›i', cues: ['Quan Ä‘iá»ƒm', 'Chá»§ Ä‘á»', 'Äá»‘i tÆ°á»£ng/Äá»‘i láº­p', 'NgÆ°á»£c láº¡i'], tip: 'ğŸ’¡ Máº¹o: ã«ã¨ã£ã¦ (Ä‘á»©ng trÃªn láº­p trÆ°á»ng ai Ä‘Ã³), ã«ã¤ã„ã¦/ã«é–¢ã—ã¦ (vá» chá»§ Ä‘á» gÃ¬ Ä‘Ã³), ã«å¯¾ã—ã¦ (hÆ°á»›ng Ä‘áº¿n Ä‘á»‘i tÆ°á»£ng nÃ o Ä‘Ã³), ã«åã—ã¦ (trÃ¡i vá»›i dá»± Ä‘oÃ¡n/quy táº¯c).', examples: [{jp:'ç§ã«ã¨ã£ã¦ã€ã“ã‚Œã¯ã¨ã¦ã‚‚å¤§åˆ‡ãªå†™çœŸã§ã™ã€‚', vn:'Äá»‘i vá»›i tÃ´i, Ä‘Ã¢y lÃ  bá»©c áº£nh ráº¥t quan trá»ng.'}, {jp:'å½¼ã®æ„è¦‹ã«å¯¾ã—ã¦ã€ç§ã¯åå¯¾ã ã€‚', vn:'TÃ´i pháº£n Ä‘á»‘i Ã½ kiáº¿n cá»§a anh áº¥y.'}], quiz: {q:'è¦ªã®æœŸå¾…ï¼¿ï¼¿ï¼¿ï¼¿ã€å½¼ã¯å¤§å­¦ã«è¡Œã‹ãªã‹ã£ãŸã€‚', options:['ã«åã—ã¦','ã«ã“ãŸãˆã¦','ã«ã¤ã„ã¦','ã«ã¨ã£ã¦'], correct:0, explain:'Káº¿t quáº£ ngÆ°á»£c láº¡i vá»›i mong Ä‘á»£i, ká»³ vá»ng.'} }
            ]
        },
        group3: {
            name: 'NhÃ³m 3 â€“ HoÃ n thiá»‡n',
            items: [
                { id: 'darake', title: 'ï½ã ã‚‰ã‘', marker: 'N + ã ã‚‰ã‘', meaning: 'ToÃ n lÃ , Ä‘áº§y...', cues: ['TiÃªu cá»±c', 'Bá»¥i, bÃ¹n, lá»—i'], tip: 'ğŸ’¡ Máº¹o: LuÃ´n mang nghÄ©a tiÃªu cá»±c. DÃ¹ng cho nhá»¯ng thá»© khÃ´ng mong muá»‘n bao phá»§ bá» máº·t (bÃ¹n, bá»¥i, lá»—i sai, ná»£...).', examples: [{jp:'å½¼ã®éƒ¨å±‹ã¯ã‚´ãƒŸã ã‚‰ã‘ã ã€‚', vn:'PhÃ²ng anh ta toÃ n lÃ  rÃ¡c.'}, {jp:'ã“ã®ãƒ¬ãƒãƒ¼ãƒˆã¯é–“é•ã„ã ã‚‰ã‘ã§ã€èª­ã¿ã«ãã„ã€‚', vn:'BÃ¡o cÃ¡o nÃ y Ä‘áº§y lá»—i nÃªn khÃ³ Ä‘á»c.'}], quiz: {q:'ã‚µãƒƒã‚«ãƒ¼ã®è©¦åˆã®å¾Œã€é¸æ‰‹ãŸã¡ã¯ï¼¿ï¼¿ï¼¿ï¼¿ã ã‚‰ã‘ã«ãªã£ãŸã€‚', options:['æ±—','æ³¥','æ¶™','å…ƒæ°—'], correct:1, explain:'ã€Œã ã‚‰ã‘ã€thÆ°á»ng Ä‘i vá»›i nhá»¯ng thá»© báº©n, khÃ´ng mong muá»‘n bÃ¡m vÃ o.'} },
                { id: 'kke', title: 'ï½ã£ã‘', marker: 'Thá»ƒ ãŸ + ã£ã‘', meaning: '...áº¥y nhá»‰? (nhá»› láº¡i)', cues: ['XÃ¡c nháº­n thÃ´ng tin Ä‘Ã£ quÃªn'], tip: 'ğŸ’¡ Máº¹o: DÃ¹ng trong vÄƒn nÃ³i thÃ¢n máº­t, Ä‘á»ƒ há»i láº¡i Ä‘iá»u mÃ¬nh khÃ´ng cháº¯c cháº¯n hoáº·c chá»£t quÃªn máº¥t.', examples: [{jp:'ä»Šæ—¥ã®ä¼šè­°ã€ä½•æ™‚ã‹ã‚‰ã ã£ã‘ï¼Ÿ', vn:'Cuá»™c há»p hÃ´m nay tá»« máº¥y giá» áº¥y nhá»‰?'}, {jp:'å»å¹´ã€ä¸€ç·’ï¼ˆã„ã£ã—ã‚‡ï¼‰ã«æ—…è¡Œï¼ˆã‚Šã‚‡ã“ã†ï¼‰ã«è¡Œï¼ˆã„ï¼‰ã£ãŸã£ã‘ï¼Ÿ', vn:'NÄƒm ngoÃ¡i, chÃºng ta Ä‘Ã£ Ä‘i du lá»‹ch cÃ¹ng nhau pháº£i khÃ´ng nhá»‰?'}], quiz: {q:'è©¦é¨“ã¯æ¥é€±ã®æœˆæ›œæ—¥ï¼¿ï¼¿ï¼¿ï¼¿ï¼Ÿ', options:['ã§ã—ãŸã£ã‘','ã§ã™ã‹','ã§ã—ã‚‡ã†','ã§ã—ã‚‡ã†ã£ã‘'], correct:0, explain:'DÃ¹ng Ä‘á»ƒ há»i xÃ¡c nháº­n láº¡i má»™t thÃ´ng tin khÃ´ng cháº¯c cháº¯n.'} },
                { id: 'marude-mitai', title: 'ï½ã¾ã‚‹ã§ï½ã¿ãŸã„ã ', marker: 'ã¾ã‚‹ã§ + Nã®/Vã‚‹ + ã‚ˆã†ã /ã¿ãŸã„ã ', meaning: 'Cá»© nhÆ° lÃ ...', cues: ['VÃ­ von', 'So sÃ¡nh'], tip: 'ğŸ’¡ Máº¹o: LuÃ´n Ä‘i kÃ¨m vá»›i ã¾ã‚‹ã§. Nháº¥n máº¡nh sá»± so sÃ¡nh, vÃ­ von má»™t cÃ¡ch cÆ°á»ng Ä‘iá»‡u.', examples: [{jp:'åˆæ ¼ã—ãŸï¼ã¾ã‚‹ã§å¤¢ã®ã‚ˆã†ã ã€‚', vn:'Äá»— rá»“i! Cá»© nhÆ° lÃ  mÆ¡ váº­y.'}], quiz: {q:'å½¼å¥³ã®æ—¥æœ¬èªã¯ã€ã¾ã‚‹ã§æ—¥æœ¬äººãŒè©±ã—ã¦ã„ã‚‹ï¼¿ï¼¿ï¼¿ï¼¿ä¸Šæ‰‹ã ã€‚', options:['ã¿ãŸã„ã«','ã‚ˆã†ã«','ã‚‰ã—ã','ã£ã½ã'], correct:1, explain:'ã€Œã‚ˆã†ã«ã€lÃ  cÃ¡ch nÃ³i trang trá»ng vÃ  phÃ¹ há»£p vÄƒn viáº¿t hÆ¡n ã€Œã¿ãŸã„ã«ã€.'} },
                { id: 'ni-watatte', title: 'ï½ã«ã‚ãŸã£ã¦', marker: 'N + ã«ã‚ãŸã£ã¦', meaning: 'Trong suá»‘t, trÃªn toÃ n (khÃ´ng gian, thá»i gian)', cues: ['Pháº¡m vi rá»™ng'], tip: 'ğŸ’¡ Máº¹o: Äi vá»›i danh tá»« chá»‰ thá»i gian (æ•°æ™‚é–“), khÃ´ng gian (å…¨å›½), sá»‘ láº§n (æ•°å›) Ä‘á»ƒ nháº¥n máº¡nh sá»± tráº£i dÃ i, rá»™ng kháº¯p.', examples: [{jp:'ä¼šè­°ã¯ï¼•æ—¥é–“ã«ã‚ãŸã£ã¦è¡Œã‚ã‚ŒãŸã€‚', vn:'Cuá»™c há»p Ä‘Ã£ diá»…n ra trong suá»‘t 5 ngÃ y.'}], quiz: {q:'å°é¢¨ã®å½±éŸ¿ã§ã€é–¢æ±åœ°æ–¹ï¼¿ï¼¿ï¼¿ï¼¿å¤§é›¨ãŒé™ã£ãŸã€‚', options:['ã‚’è¾¼ã‚ã¦','ã«é–¢ã—ã¦','ã«ã‚ãŸã£ã¦','ã«ã¤ã„ã¦'], correct:2, explain:'Diá»…n táº£ pháº¡m vi Ä‘á»‹a lÃ½ rá»™ng lá»›n.'} },
                { id: 'wo-komete', title: 'ï½ã‚’è¾¼ã‚ã¦', marker: 'N + ã‚’è¾¼ã‚ã¦', meaning: 'Gá»­i gáº¯m, chá»©a Ä‘á»±ng (tÃ¬nh cáº£m)', cues: ['TÃ¬nh yÃªu', 'LÃ²ng biáº¿t Æ¡n'], tip: 'ğŸ’¡ Máº¹o: Äi vá»›i danh tá»« chá»‰ cáº£m xÃºc, tÃ¬nh cáº£m (å¿ƒ, æ„›, æ„Ÿè¬...).', examples: [{jp:'æ¯ã®èª•ç”Ÿæ—¥ã«ã€æ„Ÿè¬ã®æ°—æŒã¡ã‚’è¾¼ã‚ã¦ãƒ—ãƒ¬ã‚¼ãƒ³ãƒˆã‚’è´ˆã£ãŸã€‚', vn:'VÃ o sinh nháº­t máº¹, tÃ´i Ä‘Ã£ táº·ng quÃ  vá»›i táº¥t cáº£ lÃ²ng biáº¿t Æ¡n.'}], quiz: {q:'å½¼å¥³ã«ã€æ„›ã‚’ï¼¿ï¼¿ï¼¿ï¼¿æ‰‹ç´™ã‚’æ›¸ã„ãŸã€‚', options:['è¾¼ã‚ã¦','ã‚ãŸã£ã¦','é€šã—ã¦','ã‚ãã£ã¦'], correct:0, explain:'ã€Œã‚’è¾¼ã‚ã¦ã€dÃ¹ng Ä‘á»ƒ diá»…n táº£ hÃ nh Ä‘á»™ng lÃ m vá»›i táº¥t cáº£ tÃ¬nh cáº£m.'} },
                { id: 'ni-tsurete', title: 'ï½ã«ã¤ã‚Œã¦', marker: 'Vã‚‹/N + ã«ã¤ã‚Œã¦', meaning: 'CÃ ng... cÃ ng...', cues: ['Thay Ä‘á»•i Ä‘á»“ng thá»i'], tip: 'ğŸ’¡ Máº¹o: A thay Ä‘á»•i thÃ¬ B cÅ©ng thay Ä‘á»•i theo má»™t cÃ¡ch tá»± nhiÃªn. TÆ°Æ¡ng tá»± ã—ãŸãŒã£ã¦.', examples: [{jp:'è©¦é¨“ãŒè¿‘ã¥ãã«ã¤ã‚Œã¦ã€ã ã‚“ã ã‚“å¿ƒé…ã«ãªã£ã¦ããŸã€‚', vn:'Ká»³ thi cÃ ng Ä‘áº¿n gáº§n, tÃ´i cÃ ng cáº£m tháº¥y lo láº¯ng.'}], quiz: {q:'å¹´ã‚’å–ã‚‹ï¼¿ï¼¿ï¼¿ï¼¿ã€ä½“ãŒå¼±ããªã‚‹ã€‚', options:['ã†ã¡ã«','ãŸã³ã«','ã«ã¤ã‚Œã¦','ã°ã‹ã‚Šã«'], correct:2, explain:'Diá»…n táº£ sá»± thay Ä‘á»•i diá»…n ra Ä‘á»“ng thá»i (tuá»•i tÃ¡c vÃ  sá»©c khá»e).'} },
                { id: 'ni-tsuki', title: 'ï½ã«ã¤ã', marker: 'N + ã«ã¤ã', meaning: 'Cá»© má»—i / VÃ¬ (thÃ´ng bÃ¡o)', cues: ['Tá»· lá»‡', 'LÃ½ do trang trá»ng'], tip: 'ğŸ’¡ Máº¹o: CÃ³ 2 nghÄ©a. 1. Tá»· lá»‡ (ä¸€äººã«ã¤ã). 2. LÃ½ do (thÆ°á»ng dÃ¹ng trong cÃ¡c thÃ´ng bÃ¡o trang trá»ng á»Ÿ cá»­a hÃ ng, cÃ´ng ty).', examples: [{jp:'ã“ã®å›³æ›¸é¤¨ã§ã¯ã€ä¸€äººã«ã¤ãï¼•å†Šã¾ã§æœ¬ãŒå€Ÿã‚Šã‚‰ã‚Œã‚‹ã€‚', vn:'á» thÆ° viá»‡n nÃ y, má»—i ngÆ°á»i Ä‘Æ°á»£c mÆ°á»£n tá»‘i Ä‘a 5 cuá»‘n sÃ¡ch.'}, {jp:'æœ¬æ—¥ã¯ç¥æ—¥ã«ã¤ãã€ä¼‘æ¥­ã„ãŸã—ã¾ã™ã€‚', vn:'VÃ¬ hÃ´m nay lÃ  ngÃ y lá»… nÃªn chÃºng tÃ´i xin phÃ©p nghá»‰.'}], quiz: {q:'å·¥äº‹ä¸­ï¼¿ï¼¿ï¼¿ï¼¿ã€ã”æ³¨æ„ãã ã•ã„ã€‚', options:['ã«ã¤ã','ã«ã¤ã‚Œã¦','ã«ã¨ã£ã¦','ã«å¯¾ã—ã¦'], correct:0, explain:'DÃ¹ng trong thÃ´ng bÃ¡o Ä‘á»ƒ nÃªu lÃ½ do má»™t cÃ¡ch trang trá»ng.'} },
                { id: 'teshouganai', title: 'ï½ã¦ã—ã‚‡ã†ãŒãªã„ï¼ã¦ãªã‚‰ãªã„', marker: 'Aãã¦/Aã§ + ã¦ã—ã‚‡ã†ãŒãªã„', meaning: 'Ráº¥t, khÃ´ng chá»‹u Ä‘Æ°á»£c', cues: ['Cáº£m xÃºc tá»± nhiÃªn'], tip: 'ğŸ’¡ Máº¹o: Nháº¥n máº¡nh cáº£m xÃºc, cáº£m giÃ¡c, mong muá»‘n náº£y sinh tá»± nhiÃªn, khÃ´ng thá»ƒ kÃ¬m nÃ©n.', examples: [{jp:'éš£ã®å·¥äº‹ãŒã†ã‚‹ã•ãã¦ã—ã‚‡ã†ãŒãªã„ã€‚', vn:'CÃ´ng trÃ¬nh bÃªn cáº¡nh á»“n Ã o khÃ´ng thá»ƒ chá»‹u ná»•i.'}], quiz: {q:'ä¹…ã—ã¶ã‚Šã«å½¼å¥³ã«ä¼šãˆã‚‹ã®ã§ã€ã†ã‚Œã—ãã¦ï¼¿ï¼¿ï¼¿ï¼¿ã€‚', options:['ã»ã‹ãªã‚‰ãªã„','ã—ã‚‡ã†ãŒãªã„','ã‹ã¾ã‚ãªã„','ã¡ãŒã„ãªã„'], correct:1, explain:'Nháº¥n máº¡nh cáº£m xÃºc vui má»«ng khÃ´ng thá»ƒ kÃ¬m nÃ©n Ä‘Æ°á»£c.'} },
                { id: 'tokoro-datta', title: 'ï½ã¨ã“ã‚ã ã£ãŸ', marker: 'Vã‚‹ + ã¨ã“ã‚ã ã£ãŸ', meaning: 'SuÃ½t ná»¯a thÃ¬...', cues: ['May mÃ  khÃ´ng xáº£y ra'], tip: 'ğŸ’¡ Máº¹o: LuÃ´n Ä‘i vá»›i ã‚‚ã†å°‘ã—ã§, å±ãªã... Diá»…n táº£ má»™t chuyá»‡n xáº¥u suÃ½t xáº£y ra nhÆ°ng may máº¯n lÃ  khÃ´ng.', examples: [{jp:'ã‚‚ã†å°‘ã—ã§ã€é›»è»Šã«ä¹—ã‚Šé…ã‚Œã‚‹ã¨ã“ã‚ã ã£ãŸã€‚', vn:'Chá»‰ má»™t chÃºt ná»¯a thÃ´i lÃ  tÃ´i suÃ½t bá»‹ lá»¡ tÃ u.'}], quiz: {q:'å±ãªã‹ã£ãŸã€‚ã‚‚ã†å°‘ã—ã§è»Šã«ï¼¿ï¼¿ï¼¿ï¼¿ã¨ã“ã‚ã ã£ãŸã€‚', options:['ã²ã‹ã‚Œã‚‹','ã²ã‹ã›ã‚‰ã‚Œã‚‹','ã²ã‹ã‚Œã¦ã„ã‚‹','ã²ã‹ã›ã‚‹'], correct:0, explain:'Äi vá»›i Vã‚‹, diá»…n táº£ má»™t viá»‡c xáº¥u suÃ½t Ä‘Ã£ xáº£y ra.'} },
                { id: 'te-miseru', title: 'ï½ã¦ã¿ã›ã‚‹', marker: 'Vã¦ + ã¿ã›ã‚‹', meaning: 'LÃ m cho mÃ  xem (thá»ƒ hiá»‡n quyáº¿t tÃ¢m)', cues: ['Quyáº¿t tÃ¢m', 'Chá»©ng tá»'], tip: 'ğŸ’¡ Máº¹o: Thá»ƒ hiá»‡n Ã½ chÃ­ máº¡nh máº½ "tÃ´i sáº½ lÃ m vÃ  cho báº¡n tháº¥y káº¿t quáº£!".', examples: [{jp:'ä»Šåº¦ã“ãã€å¿…ãšN3ã«åˆæ ¼ã—ã¦ã¿ã›ã‚‹ã€‚', vn:'Láº§n nÃ y, nháº¥t Ä‘á»‹nh tÃ´i sáº½ Ä‘á»— N3 cho mÃ  xem.'}], quiz: {q:'ã€Œã§ããªã„ã€ãªã‚“ã¦è¨€ã‚ã›ãªã„ã€‚çµ¶å¯¾ã«ï¼¿ï¼¿ï¼¿ï¼¿ã€‚', options:['æˆåŠŸã™ã‚‹ã¯ãšã ','æˆåŠŸã—ã¦ã¿ã›ã‚‹','æˆåŠŸã™ã‚‹ã‚ã‘ãŒãªã„','æˆåŠŸã—ãŸã‚‰ã—ã„'], correct:1, explain:'Thá»ƒ hiá»‡n Ã½ chÃ­ vÃ  quyáº¿t tÃ¢m máº¡nh máº½ sáº½ lÃ m Ä‘Æ°á»£c Ä‘iá»u gÃ¬ Ä‘Ã³.'} }
            ]
        }
    };

    let state;

    function initialize() {
        loadState();
        window.addEventListener('keydown', keyHandler);
        window.addEventListener('beforeunload', saveState);
        renderTabs();
        render();
    }
    
    // --- GEMINI API CALLER & HELPERS (Redacted for brevity, same as previous version) ---
    async function callGemini(prompt, buttonElement) {
        const originalText = buttonElement.innerHTML;
        buttonElement.innerHTML = '<span class="loader"></span> Äang xá»­ lÃ½...';
        buttonElement.disabled = true;
		const encodedKey = localStorage.getItem('jMasterApiKey') || "";
		const apiKey = encodedKey ? atob(encodedKey) : "";
        if (!apiKey) {
             return Promise.reject(new Error("API Key khÃ´ng Ä‘Æ°á»£c tÃ¬m tháº¥y. Vui lÃ²ng kiá»ƒm tra CÃ i Ä‘áº·t."));
        }
        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;
        try {
            const response = await fetch(apiUrl, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
            });
            if (!response.ok) {
                 const errorBody = await response.json();
                 const errorMessage = errorBody?.error?.message || `API call failed with status: ${response.status}`;
                 throw new Error(errorMessage);
            }
            const result = await response.json();
            const text = result.candidates?.[0]?.content?.parts?.[0]?.text;
            return text;
        } catch (error) {
            console.error("Gemini API error:", error);
            throw error; // Re-throw the error to be caught by the calling function
        } finally {
            buttonElement.innerHTML = originalText;
            buttonElement.disabled = false;
        }
    }
    
    const progressBar = document.getElementById('progress-bar');
    const statsContainer = document.getElementById('stats');
    const sidebarContainer = document.getElementById('sidebar');
    const mainPanelContainer = document.getElementById('main-panel');
mainPanelContainer.addEventListener('click', function(e) {
    // TÃ¬m nÃºt Ä‘Ã¡p Ã¡n Ä‘Æ°á»£c click
    const optionButton = e.target.closest('.ai-quiz-option');
    if (!optionButton) return; // Náº¿u khÃ´ng pháº£i click vÃ o nÃºt Ä‘Ã¡p Ã¡n thÃ¬ bá» qua

    const questionContainer = optionButton.closest('.ai-quiz-question');
    // Náº¿u cÃ¢u há»i Ä‘Ã£ Ä‘Æ°á»£c tráº£ lá»i rá»“i thÃ¬ khÃ´ng lÃ m gÃ¬ cáº£
    if (questionContainer.dataset.answered === 'true') return;

    // ÄÃ¡nh dáº¥u lÃ  Ä‘Ã£ tráº£ lá»i
    questionContainer.dataset.answered = 'true';
    const isCorrect = optionButton.dataset.correct === 'true';
    const allOptions = questionContainer.querySelectorAll('.ai-quiz-option');

    // VÃ´ hiá»‡u hÃ³a táº¥t cáº£ cÃ¡c nÃºt vÃ  hiá»ƒn thá»‹ Ä‘Ã¡p Ã¡n Ä‘Ãºng
    allOptions.forEach(btn => {
        btn.disabled = true;
        const wasCorrectChoice = btn.dataset.correct === 'true';
        if (wasCorrectChoice) {
            btn.classList.add('border-emerald-400', 'bg-emerald-500/10', 'text-emerald-300');
        }
    });

    // Náº¿u chá»n sai, tÃ´ Ä‘á» lá»±a chá»n sai
    if (!isCorrect) {
        optionButton.classList.add('border-rose-500', 'bg-rose-500/10', 'text-rose-300');
    }

    // Hiá»ƒn thá»‹ pháº§n giáº£i thÃ­ch
    questionContainer.querySelector('.ai-quiz-explain').classList.remove('hidden');
});
    const surpriseToast = document.getElementById('surprise-toast');
    const confettiContainer = document.getElementById('confetti-container');
    const groupTabsContainer = document.getElementById('group-tabs');
    const headerTitle = document.getElementById('header-title');

    function shuffle(arr) { for (let i = arr.length - 1; i > 0; i--) { const j = Math.floor(Math.random() * (i + 1)); [arr[i], arr[j]] = [arr[j], arr[i]]; } return arr; }

    function saveState() {
        const stateToSave = { currentGroup: state.currentGroup, orders: state.orders, indices: state.indices, scores: state.scores, streak: state.streak };
        localStorage.setItem('n3_grammar_state_v3', JSON.stringify(stateToSave));
    }

    function loadState() {
        const savedState = localStorage.getItem('n3_grammar_state_v3');
        state = savedState ? JSON.parse(savedState) : { currentGroup: 'group1', orders: {}, indices: {}, scores: {}, streak: 0 };
        ['group1', 'group2', 'group3'].forEach(g => {
            if (!state.orders[g] || state.orders[g].length !== grammarGroups[g].items.length) {
                state.orders[g] = shuffle([...Array(grammarGroups[g].items.length).keys()]);
            }
            state.indices[g] = state.indices[g] || 0;
            state.scores[g] = state.scores[g] || { correct: 0, total: 0 };
        });
    }
    
    function switchGroup(groupKey) {
        state.currentGroup = groupKey;
        state.mode = 'learn'; state.picked = null; state.result = null;
        renderTabs(); render();
    }
    
    function renderTabs() {
        groupTabsContainer.innerHTML = Object.keys(grammarGroups).map(key => `
            <button onclick="switchGroup('${key}')" class="flex-1 px-3 py-2 text-sm font-bold rounded-lg transition ${state.currentGroup === key ? 'tab-active' : 'bg-white/5 hover:bg-white/10'}">
                ${grammarGroups[key].name}
            </button>
        `).join('');
    }

    function render() {
        const group = grammarGroups[state.currentGroup];
        const groupState = {
            order: state.orders[state.currentGroup],
            idx: state.indices[state.currentGroup],
            score: state.scores[state.currentGroup],
        };
        const total = group.items.length;
        const i = groupState.order[groupState.idx % total];
        const it = group.items[i];
        
        const progress = ((groupState.idx % total) + 1) / total * 100;
        progressBar.style.width = progress + '%';
        headerTitle.textContent = `Flow há»c liÃªn tá»¥c â€” ${group.name}`;

        statsContainer.innerHTML = `
            <span class="px-3 py-1 rounded-full bg-white/5 border border-white/10">Streak: <b>${state.streak}</b></span>
            <span class="px-3 py-1 rounded-full bg-white/5 border border-white/10">Äiá»ƒm: <b>${groupState.score.correct}</b>/<b>${groupState.score.total}</b></span>
            <button onclick="resetCurrentGroup()" class="px-3 py-1 rounded-lg bg-indigo-500/20 hover:bg-indigo-500/30 border border-indigo-400/40">ğŸ”€ LÃ m má»›i nhÃ³m</button>
        `;

        sidebarContainer.innerHTML = `
             <div class="rounded-xl bg-white/5 border border-white/10 p-4 shadow-[0_10px_30px_rgba(0,0,0,.25)]">
                <div class="text-xs uppercase tracking-widest text-slate-400">BÃ i ${ (groupState.idx % total) + 1 } / ${total}</div>
                <div class="text-lg font-bold">${it.title}</div>
                <div class="text-sky-300 font-mono text-sm mt-1">${it.marker}</div>
                <p class="mt-2 text-slate-300">${it.meaning}</p>
                <div class="flex flex-wrap gap-2 mt-3">${it.cues.map(c => `<span class="px-2 py-1 rounded-full bg-white/5 border border-white/10 text-xs">${c}</span>`).join('')}</div>
                <div class="flex gap-2 mt-4">
                    <button onclick="setMode('learn')" class="flex-1 px-3 py-1.5 rounded-lg border ${state.mode === 'learn' ? 'bg-indigo-500/30 border-indigo-400/60' : 'bg-white/5 border-white/10 hover:bg-white/10'}">ğŸ“˜ Há»c</button>
                    <button onclick="setMode('quiz')" class="flex-1 px-3 py-1.5 rounded-lg border ${state.mode === 'quiz' ? 'bg-indigo-500/30 border-indigo-400/60' : 'bg-white/5 border-white/10 hover:bg-white/10'}">ğŸ§ª Quiz</button>
                </div>
            </div>
            <div class="mt-3 rounded-xl bg-white/5 border border-white/10 p-4 shadow-[0_10px_30px_rgba(0,0,0,.25)]">
                 <div class="font-bold mb-2">Äiá»u khiá»ƒn nhanh</div>
                 <ul class="space-y-1 text-sm text-slate-300">
                     <li><span class="inline-block text-center w-12 px-2 py-[2px] rounded-md border border-white/30 bg-[#0e1838] font-mono text-[12px]">Space</span> chuyá»ƒn Há»c/Quiz</li>
                     <li><span class="inline-block text-center w-12 px-2 py-[2px] rounded-md border border-white/30 bg-[#0e1838] font-mono text-[12px]">1â€‘4</span> chá»n Ä‘Ã¡p Ã¡n</li>
                     <li><span class="inline-block text-center w-12 px-2 py-[2px] rounded-md border border-white/30 bg-[#0e1838] font-mono text-[12px]">Enter</span> Next khi Ä‘Ãºng</li>
                     <li><span class="inline-block text-center w-12 px-2 py-[2px] rounded-md border border-white/30 bg-[#0e1838] font-mono text-[12px]">â†/â†’</span> lui/tiáº¿n má»¥c</li>
                 </ul>
            </div>
        `;
        
        if (state.mode === 'learn') {
            mainPanelContainer.innerHTML = `
                <div class="rounded-xl bg-white/5 border border-white/10 p-4 shadow-[0_10px_30px_rgba(0,0,0,.25)]">
                    <div class="font-semibold mb-2">VÃ­ dá»¥ & giáº£i thÃ­ch</div>
                    <div id="examples-container" class="space-y-3">${it.examples.map(ex => `<div class="p-3 rounded-lg bg-white/5 border border-white/10"><div class="font-semibold text-sky-200">${ex.jp}</div><div class="text-slate-300">${ex.vn}</div></div>`).join('')}</div>
                    <div class="mt-4 flex gap-2">
                        <button onclick="generateExample(this)" class="px-4 py-2 rounded-lg bg-purple-500/20 hover:bg-purple-500/30 border border-purple-400/40 text-sm flex items-center gap-2">âœ¨ Táº¡o thÃªm vÃ­ dá»¥</button>
                        <button onclick="generateGrammarQuizAI(this)" class="px-4 py-2 rounded-lg bg-pink-500/20 hover:bg-pink-500/30 border border-pink-400/40 text-sm flex items-center gap-2">ğŸ§  Táº¡o quiz khÃ³ vá»›i AI</button>
                    </div>
                    <div id="gemini-quiz-response" class="mt-4"></div>
                    <div class="mt-4 flex gap-2">
                        <button onclick="prev()" class="px-4 py-2 rounded-lg bg-white/10 hover:bg-white/20 border border-white/20">â¬… TrÆ°á»›c</button>
                        <button onclick="next(1)" class="px-4 py-2 rounded-lg bg-indigo-500/20 hover:bg-indigo-500/30 border border-indigo-400/40">Tiáº¿p âœ</button>
                    </div>
                </div>
                 <div class="mt-4 rounded-xl bg-white/5 border border-white/10 p-4 shadow-[0_10px_30px_rgba(0,0,0,.25)]">
                    <div class="font-semibold mb-2">Máº¹o tá»‘c Ä‘á»™</div>
                    <div class="text-sky-200">${it.tip}</div>
                </div>`;
        } else {
            let optionsHtml = it.quiz.options.map((op, k) => {
                const isPick = state.picked === k;
                const isOK = state.result && (k === it.quiz.correct);
                let btnClass = 'text-left p-3 rounded-lg border transition ';
                if (state.result) { isOK ? btnClass += 'bg-emerald-500/20 border-emerald-400/50' : isPick ? btnClass += 'bg-rose-500/20 border-rose-400/50' : btnClass += 'bg-white/5 border-white/10';
                } else { btnClass += isPick ? 'bg-white/10 border-white/30' : 'bg-white/5 border-white/10 hover:bg-white/10'; }
                return `<button onclick="choose(${k})" class="${btnClass}"><div class="flex items-center gap-2"><span class="px-2 py-[2px] rounded-md border border-white/30 bg-[#0e1838] font-mono text-[12px]">${k+1}</span><span>${op}</span></div></button>`;
            }).join('');
            let feedbackHtml = '';
            if (state.result) {
                const isCorrect = state.result === 'correct';
                let wrongAnswerAnalysisButton = !isCorrect ? `<button onclick="analyzeWrongAnswer(this)" class="mt-3 px-3 py-1.5 rounded-lg bg-yellow-500/20 hover:bg-yellow-500/30 border border-yellow-400/40 text-sm flex items-center gap-2">âœ¨ Giáº£i thÃ­ch lá»—i sai</button>` : '';
                feedbackHtml = `<div class="mt-3 p-3 rounded-lg border ${isCorrect ? 'bg-emerald-500/10 border-emerald-400/40' : 'bg-rose-500/10 border-rose-400/40'}">${isCorrect ? 'âœ… ChÃ­nh xÃ¡c! ' : 'âŒ ChÆ°a Ä‘Ãºng. '}<span class="text-slate-300">${it.quiz.explain}</span>${wrongAnswerAnalysisButton}<div id="gemini-analysis-response" class="mt-3 text-sm"></div></div>`;
            }
            mainPanelContainer.innerHTML = `<div class="rounded-xl bg-white/5 border border-white/10 p-4 shadow-[0_10px_30px_rgba(0,0,0,.25)]"><div class="text-sm uppercase tracking-widest text-slate-400">Quiz nhanh</div><div class="text-lg font-bold mb-3">${it.quiz.q}</div><div class="grid md:grid-cols-2 gap-2">${optionsHtml}</div>${feedbackHtml}<div class="mt-4 flex gap-2"><button onclick="prev()" class="px-4 py-2 rounded-lg bg-white/10 hover:bg-white/20 border border-white/20">â¬… TrÆ°á»›c</button><button onclick="${state.result === 'correct' ? 'next(1)' : 'setMode(\'learn\')'}" class="px-4 py-2 rounded-lg bg-indigo-500/20 hover:bg-indigo-500/30 border border-indigo-400/40">${state.result === 'correct' ? 'Tiáº¿p âœ' : 'Xem láº¡i'}</button></div></div>`;
        }
    }

    function next(step=1){ state.indices[state.currentGroup] = (state.indices[state.currentGroup] + step + grammarGroups[state.currentGroup].items.length) % grammarGroups[state.currentGroup].items.length; setMode('learn'); }
    function prev(){ next(-1); }
    function setMode(newMode) { state.mode = newMode; state.picked = null; state.result = null; render(); }
    function resetCurrentGroup() { state.orders[state.currentGroup] = shuffle([...grammarGroups[state.currentGroup].items.keys()]); state.indices[state.currentGroup] = 0; state.scores[state.currentGroup] = { correct: 0, total: 0 }; state.streak = 0; showSurprise(`ÄÃ£ lÃ m má»›i ${grammarGroups[state.currentGroup].name} âœ¨`); render(); }

    function choose(k) {
        if (state.mode !== 'quiz' || state.result) return;
        const group = grammarGroups[state.currentGroup];
        const it = group.items[state.orders[state.currentGroup][state.indices[state.currentGroup] % group.items.length]];
        state.picked = k;
        const isCorrect = k === it.quiz.correct;
        state.result = isCorrect ? 'correct' : 'wrong';
        state.scores[state.currentGroup].total++;
        if(isCorrect) {
            state.scores[state.currentGroup].correct++;
            state.streak++;
            showConfetti();
            if(state.streak > 0 && state.streak % 5 === 0) showSurprise(`ğŸ”¥ Combo ${state.streak}! Báº¡n tháº­t xuáº¥t sáº¯c!`);
        } else {
            state.streak = 0;
            showSurprise('ğŸ˜º KhÃ´ng sao! HÃ£y thá»­ tÃ­nh nÄƒng giáº£i thÃ­ch lá»—i sai nhÃ©.');
        }
        render();
    }
    
    async function generateExample(buttonElement) {
        const it = grammarGroups[state.currentGroup].items[state.orders[state.currentGroup][state.indices[state.currentGroup]]];
        const responseContainer = document.getElementById('gemini-example-response');
        responseContainer.innerHTML = '';
        try {
            const prompt = `Báº¡n lÃ  má»™t giÃ¡o viÃªn tiáº¿ng Nháº­t. HÃ£y táº¡o thÃªm 2 cÃ¢u vÃ­ dá»¥ má»›i vÃ  thá»±c táº¿ cho máº«u ngá»¯ phÃ¡p N3 "${it.title}" (${it.meaning}). Cho má»—i cÃ¢u, hÃ£y cung cáº¥p cÃ¢u tiáº¿ng Nháº­t, phiÃªn Ã¢m Hiragana, vÃ  dá»‹ch nghÄ©a tiáº¿ng Viá»‡t. TrÃ¬nh bÃ y rÃµ rÃ ng.`;
            const responseText = await callGemini(prompt, buttonElement);
            responseContainer.innerHTML = `<div class="p-3 mt-3 rounded-lg bg-purple-500/10 border border-purple-400/30 gemini-response">${responseText}</div>`;
        } catch (error) {
            responseContainer.innerHTML = `<div class="p-3 mt-3 rounded-lg bg-rose-500/10 border border-rose-400/30 gemini-response">Lá»—i: ${error.message}</div>`;
        }
    }

    async function generateGrammarQuizAI(buttonElement) {
        const it = grammarGroups[state.currentGroup].items[state.orders[state.currentGroup][state.indices[state.currentGroup]]];
        const responseContainer = document.getElementById('gemini-quiz-response');
        responseContainer.innerHTML = ''; // XÃ³a káº¿t quáº£ cÅ©

        try {
            const prompt = `
            Táº¡o 5 cÃ¢u há»i tráº¯c nghiá»‡m ngá»¯ phÃ¡p tiáº¿ng Nháº­t trÃ¬nh Ä‘á»™ N3 vá» máº«u: "${it.title}" (${it.meaning}).
            YÃŠU Cáº¦U:
            - Má»—i cÃ¢u há»i pháº£i cÃ³ ngá»¯ cáº£nh thá»±c táº¿.
            - 4 lá»±a chá»n Ä‘Ã¡p Ã¡n, trong Ä‘Ã³ cÃ³ 1 Ä‘Ã¡p Ã¡n Ä‘Ãºng vÃ  3 Ä‘Ã¡p Ã¡n gÃ¢y nhiá»…u há»£p lÃ½.
            - Cung cáº¥p giáº£i thÃ­ch ngáº¯n gá»n cho Ä‘Ã¡p Ã¡n Ä‘Ãºng.
            - Dá»‹ch cÃ¢u há»i sang tiáº¿ng Viá»‡t.

            TRáº¢ Vá»€ Káº¾T QUáº¢ DÆ¯á»šá»šI Dáº NG Má»˜T CHUá»–I JSON STRINGIFY Cá»¦A Má»˜T Máº¢NG (ARRAY) DUY NHáº¤T, KHÃ”NG GIáº¢I THÃCH GÃŒ THÃŠM.
            Cáº¥u trÃºc má»—i object trong máº£ng:
            {
              "jp": "CÃ¢u há»i tiáº¿ng Nháº­t cÃ³ chá»— trá»‘ng, vÃ­ dá»¥: ã€Œé ­ãŒç—›ã„ã®ã§ã€ä»Šæ—¥ã¯ä¼šç¤¾ã‚’ï¼¿ï¼¿ï¼¿ã€‚ã€",
              "vn": "Dá»‹ch nghÄ©a tiáº¿ng Viá»‡t",
              "options": ["ä¼‘ã¿ã¾ã™", "ä¼‘ã¾ã›ã¾ã™", "ä¼‘ã¾ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“", "ä¼‘ã¿ãŸã„ã§ã™"],
              "correct": 0,
              "explain": "Giáº£i thÃ­ch ngáº¯n gá»n táº¡i sao Ä‘Ã¢y lÃ  Ä‘Ã¡p Ã¡n Ä‘Ãºng."
            }
            `;

            const responseText = await callGemini(prompt, buttonElement);

            if (!responseText) {
                throw new Error("AI khÃ´ng tráº£ vá» pháº£n há»“i.");
            }

            // Dá»n dáº¹p chuá»—i JSON tráº£ vá» tá»« AI
            let cleanedText = responseText.trim();
            if (cleanedText.startsWith("```json")) {
                cleanedText = cleanedText.substring(7, cleanedText.length - 3).trim();
            } else if (cleanedText.startsWith("```")) {
                 cleanedText = cleanedText.substring(3, cleanedText.length - 3).trim();
            }

            const quizArr = JSON.parse(cleanedText);

            if (!Array.isArray(quizArr) || quizArr.length === 0) {
                throw new Error("Dá»¯ liá»‡u tráº£ vá» khÃ´ng pháº£i lÃ  má»™t máº£ng cÃ¢u há»i há»£p lá»‡.");
            }

            // Táº¡o HTML cho quiz, chuyá»ƒn tá»« <div> sang <button> Ä‘á»ƒ tÆ°Æ¡ng tÃ¡c
            const quizHtml = quizArr.map((q, idx) => `
                <div class="ai-quiz-question mb-6 p-4 rounded-xl bg-pink-500/10 border border-pink-400/30 gemini-response" data-question-index="${idx}">
                    <div class="font-bold text-pink-300 mb-1">CÃ¢u há»i AI ${idx + 1}:</div>
                    <div class="font-semibold text-sky-200">${q.jp}</div>
                    <div class="text-slate-300 mb-2">${q.vn}</div>
                    <div class="ai-quiz-options grid md:grid-cols-2 gap-2 mb-2">
                        ${q.options.map((op, k) => `
                            <button class="ai-quiz-option p-2 rounded-lg border border-white/10 bg-white/5 text-left transition hover:bg-white/10" data-correct="${k === q.correct}">
                               ${String.fromCharCode(65 + k)}. ${op}
                            </button>`).join('')}
                    </div>
                    <div class="ai-quiz-explain text-yellow-300 text-sm hidden mt-2">ğŸ’¡ Giáº£i thÃ­ch: ${q.explain}</div>
                </div>
            `).join('');
            responseContainer.innerHTML = quizHtml;

        } catch (e) {
            console.error("Lá»—i khi táº¡o AI quiz:", e);
            let errorMessage = `KhÃ´ng thá»ƒ táº¡o quiz. Vui lÃ²ng thá»­ láº¡i.`;
            if (e.message.toLowerCase().includes("json")) {
                errorMessage = "AI Ä‘Ã£ tráº£ vá» dá»¯ liá»‡u khÃ´ng há»£p lá»‡. Vui lÃ²ng thá»­ láº¡i.";
            } else if (e.message.toLowerCase().includes("api")) {
                errorMessage = `Lá»—i API: ${e.message}. HÃ£y kiá»ƒm tra láº¡i API Key trong pháº§n CÃ i Ä‘áº·t.`;
            }
            responseContainer.innerHTML = `<div class="p-3 rounded-lg bg-rose-500/10 border border-rose-400/30">${errorMessage}</div>`;
        }
    }

    async function analyzeWrongAnswer(buttonElement) {
        const group = grammarGroups[state.currentGroup];
        const it = group.items[state.orders[state.currentGroup][state.indices[state.currentGroup]]];
        const userAnswer = it.quiz.options[state.picked];
        const correctAnswer = it.quiz.options[it.quiz.correct];
        const responseContainer = document.getElementById('gemini-analysis-response');
        responseContainer.innerHTML = '';
        try {
            const prompt = `TÃ´i Ä‘ang lÃ m má»™t cÃ¢u há»i tráº¯c nghiá»‡m ngá»¯ phÃ¡p JLPT N3.\nCÃ¢u há»i lÃ : "${it.quiz.q}"\nTÃ´i Ä‘Ã£ chá»n Ä‘Ã¡p Ã¡n: "${userAnswer}"\nÄÃ¡p Ã¡n Ä‘Ãºng lÃ : "${correctAnswer}"\n\nHÃ£y Ä‘Ã³ng vai má»™t gia sÆ° AI thÃ¢n thiá»‡n, giáº£i thÃ­ch cho tÃ´i báº±ng tiáº¿ng Viá»‡t táº¡i sao Ä‘Ã¡p Ã¡n cá»§a tÃ´i (${userAnswer}) láº¡i sai trong ngá»¯ cáº£nh nÃ y, vÃ  táº¡i sao Ä‘Ã¡p Ã¡n Ä‘Ãºng (${correctAnswer}) láº¡i lÃ  lá»±a chá»n phÃ¹ há»£p nháº¥t. Giáº£i thÃ­ch ngáº¯n gá»n, táº­p trung vÃ o báº£n cháº¥t ngá»¯ phÃ¡p.`;
            const responseText = await callGemini(prompt, buttonElement);
            responseContainer.innerHTML = `<div class="p-3 mt-3 rounded-lg bg-yellow-500/10 border border-yellow-400/30 gemini-response">${responseText}</div>`;
        } catch (error) {
             responseContainer.innerHTML = `<div class="p-3 mt-3 rounded-lg bg-rose-500/10 border border-rose-400/30 gemini-response">Lá»—i: ${error.message}</div>`;
        }
    }

    function showSurprise(message) { surpriseToast.innerHTML = `<div class="px-4 py-2 rounded-xl bg-[#0a142c] border border-white/15 shadow-xl">${message}<button onclick="hideSurprise()" class="ml-3 text-sky-300 underline">ÄÃ³ng</button></div>`; surpriseToast.classList.remove('opacity-0', 'pointer-events-none'); setTimeout(hideSurprise, 5000); }
    function hideSurprise() { surpriseToast.classList.add('opacity-0', 'pointer-events-none'); }
    function showConfetti() { let bitsHtml = ''; for (let i = 0; i < 18; i++) { bitsHtml += `<div style="left:${Math.random()*100}%" class="confetti-bit"><div style="transform:rotate(${Math.random()*360}deg)" class="w-2 h-3 rounded-sm bg-gradient-to-br from-emerald-400 to-sky-400"></div></div>`; } confettiContainer.innerHTML = bitsHtml; setTimeout(() => confettiContainer.innerHTML = '', 1200); }

    function keyHandler(e) {
        if (['1', '2', '3', '4'].includes(e.key) && state.mode === 'quiz') choose(Number(e.key) - 1);
        if (e.key === 'ArrowRight') next();
        if (e.key === 'ArrowLeft') prev();
        if (e.key === ' ') { e.preventDefault(); setMode(state.mode === 'learn' ? 'quiz' : 'learn'); }
        if (e.key === 'Enter' && state.result === 'correct') next();
    }
    
    document.addEventListener('DOMContentLoaded', initialize);
</script>
</body>
</html>